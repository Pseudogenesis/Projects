{
  "SaveName": "",
  "Date": "",
  "VersionNumber": "",
  "GameMode": "",
  "GameType": "",
  "GameComplexity": "",
  "Tags": [],
  "Gravity": 0.5,
  "PlayArea": 0.5,
  "Table": "",
  "Sky": "",
  "Note": "",
  "TabStates": {},
  "LuaScript": "",
  "LuaScriptState": "",
  "XmlUI": "",
  "ObjectStates": [
    {
      "GUID": "Tempers_of_the_Ever-Changing_Skies",
      "Name": "Custom_Tile",
      "Transform": {
        "posX": -45.6189232,
        "posY": 0.8833177,
        "posZ": 115.099266,
        "rotX": -1.0579296e-05,
        "rotY": 179.9999,
        "rotZ": 0.56096375,
        "scaleX": 5.46,
        "scaleY": 1.0,
        "scaleZ": 5.46
      },
      "Nickname": "Tempers of the Ever-Changing Skies",
      "Description": "",
      "GMNotes": "",
      "AltLookAngle": {
        "x": 0.0,
        "y": 0.0,
        "z": 0.0
      },
      "ColorDiffuse": {
        "r": 0.2002995,
        "g": 0.16029951,
        "b": 0.15179953
      },
      "Tags": [
        "Spirit"
      ],
      "LayoutGroupSortIndex": 0,
      "Value": 0,
      "Locked": false,
      "Grid": true,
      "Snap": true,
      "IgnoreFoW": false,
      "MeasureMovement": false,
      "DragSelectable": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "https://steamusercontent-a.akamaihd.net/ugc/9970943713431201118/CBFAD90471C248223D5B9C740A9DC7F6CA73EDE7/",
        "ImageSecondaryURL": "https://steamusercontent-a.akamaihd.net/ugc/9970943713431201118/CBFAD90471C248223D5B9C740A9DC7F6CA73EDE7/",
        "ImageScalar": 1.0,
        "WidthScale": 0.0,
        "CustomTile": {
          "Type": 0,
          "Thickness": 0.2,
          "Stackable": false,
          "Stretch": true
        }
      },
      "LuaScript": "-- Spirit Panel for MJ & iakona's Spirit Island Mod --\nuseProgression = false\nuseAspect = 2\n\nfunction onLoad(saved_data)\n    Color.Add(\"SoftBlue\", Color.new(0.53,0.92,1))\n    Color.Add(\"SoftYellow\", Color.new(1,0.8,0.5))\n    getObjectFromGUID(\"SourceSpirit\").call(\"load\", {obj = self, saved_data = saved_data})\nend",
      "LuaScriptState": "{\"bonusEnergy\":[],\"thresholds\":[{\"elements\":\"02020000\",\"position\":{\"x\":0.34,\"y\":0,\"z\":0.45}}],\"trackElements\":[{\"elements\":\"01000000\",\"position\":{\"x\":-0.503,\"y\":0,\"z\":-0.4427}}],\"trackEnergy\":[{\"count\":3,\"position\":{\"x\":-0.9584,\"y\":0,\"z\":-0.4427}},{\"count\":2,\"position\":{\"x\":-0.2753,\"y\":0,\"z\":-0.4427}},{\"count\":1,\"position\":{\"x\":0.1801,\"y\":0,\"z\":-0.4427}}]}",
      "XmlUI": "",
      "AttachedSnapPoints": [
        {
          "Position": {
            "x": -0.0476,
            "y": 0.2,
            "z": -0.4427
          }
        },
        {
          "Position": {
            "x": -0.2753,
            "y": 0.2,
            "z": -0.4427
          }
        },
        {
          "Position": {
            "x": -0.503,
            "y": 0.2,
            "z": -0.4427
          }
        },
        {
          "Position": {
            "x": -0.7307,
            "y": 0.2,
            "z": -0.4427
          }
        },
        {
          "Position": {
            "x": -0.9584,
            "y": 0.2,
            "z": -0.4427
          }
        },
        {
          "Position": {
            "x": -0.0476,
            "y": 0.2,
            "z": -0.0743
          }
        },
        {
          "Position": {
            "x": -0.2753,
            "y": 0.2,
            "z": -0.0743
          }
        },
        {
          "Position": {
            "x": -0.503,
            "y": 0.2,
            "z": -0.0743
          }
        },
        {
          "Position": {
            "x": -0.7307,
            "y": 0.2,
            "z": -0.0743
          }
        },
        {
          "Position": {
            "x": -0.9584,
            "y": 0.2,
            "z": -0.0743
          }
        },
        {
          "Position": {
            "x": -1.1861,
            "y": 0.2,
            "z": -0.0743
          }
        }
      ],
      "ChildObjects": [
        {
          "GUID": "fddf31",
          "Name": "Custom_Model",
          "Transform": {
            "posX": -0.233887151,
            "posY": 0.209863573,
            "posZ": 0.707194269,
            "rotX": -0.00202481751,
            "rotY": 89.824295,
            "rotZ": 0.3023939,
            "scaleX": 1.83154309,
            "scaleY": 9.998757,
            "scaleZ": 1.83150148
          },
          "Nickname": "Change Season Script",
          "Description": "",
          "GMNotes": "",
          "AltLookAngle": {
            "x": 0.0,
            "y": 0.0,
            "z": 0.0
          },
          "ColorDiffuse": {
            "r": 1.0,
            "g": 1.0,
            "b": 1.0,
            "a": 0.0
          },
          "Tags": [
            "Setup",
            "Time Passes",
            "Modify Cost"
          ],
          "LayoutGroupSortIndex": 0,
          "Value": 0,
          "Locked": false,
          "Grid": false,
          "Snap": false,
          "IgnoreFoW": false,
          "MeasureMovement": false,
          "DragSelectable": true,
          "Autoraise": true,
          "Sticky": true,
          "Tooltip": true,
          "GridProjection": false,
          "HideWhenFaceDown": false,
          "Hands": false,
          "CustomMesh": {
            "MeshURL": "https://steamusercontent-a.akamaihd.net/ugc/1754683441115249154/B284A821AE46B04E3399AE51B6B94ED0BEFC5F92/",
            "DiffuseURL": "",
            "NormalURL": "",
            "ColliderURL": "",
            "Convex": true,
            "MaterialIndex": 0,
            "TypeIndex": 0,
            "CastShadows": true
          },
          "LuaScript": "-- Season Change Script for Tempers of the Ever-Changing Skies --\n-- Runs from invisible attached child object --\n-- Self-initializes via onLoad since mod doesn't call doSetup on child objects --\n\nlocal spiritName = \"Tempers of the Ever-Changing Skies\"\nlocal impendTable = {}\nlocal pos\n-- Wheel states: 1=Ire, 2=Joy, 3=Calm, 4=Sorrow\nlocal EMOTIONS = {\"Ire\", \"Joy\", \"Calm\", \"Sorrow\"}\nlocal seasonWheel = nil\nlocal playerColor = nil\nlocal busy = false  -- Prevents rapid clicking\nlocal spiritPanel = nil  -- Reference to parent panel\nlocal initialized = false  -- Prevent double initialization\n\n-----------------------------------------\n-- Forward declarations for local functions\n-----------------------------------------\nlocal getWheelEmotion\nlocal setWheelToEmotion\nlocal findInnateWithTagInHand\nlocal findInnateWithTagInHandObjects\nlocal getEmotionIndex\nlocal getNextEmotionIndex\n\n-----------------------------------------\n-- Local function implementations\n-----------------------------------------\n\ngetWheelEmotion = function()\n    if not seasonWheel then return \"Ire\" end\n    local stateId = seasonWheel.getStateId()\n    if stateId == -1 then stateId = 1 end\n    return EMOTIONS[stateId] or \"Ire\"\nend\n\nsetWheelToEmotion = function(emotionTag)\n    if not seasonWheel then return end\n\n    local targetState = 1\n    for i, emotion in ipairs(EMOTIONS) do\n        if emotion == emotionTag then\n            targetState = i\n            break\n        end\n    end\n\n    local currentState = seasonWheel.getStateId()\n    if currentState == -1 then currentState = 1 end\n\n    if targetState ~= currentState then\n        seasonWheel = seasonWheel.setState(targetState)\n    end\nend\n\nfindInnateWithTagInHand = function(color, handIndex, tagName)\n    local hand = Player[color].getHandObjects(handIndex)\n    for _, obj in ipairs(hand) do\n        if obj.hasTag(\"Innate\") and obj.hasTag(tagName) then\n            return obj\n        end\n    end\n    return nil\nend\n\nfindInnateWithTagInHandObjects = function(handObjects, tagName)\n    for _, obj in ipairs(handObjects) do\n        if obj.hasTag(\"Innate\") and obj.hasTag(tagName) then\n            return obj\n        end\n    end\n    return nil\nend\n\ngetEmotionIndex = function(card)\n    for i, tag in ipairs(EMOTIONS) do\n        if card.hasTag(tag) then return i end\n    end\n    return 1\nend\n\ngetNextEmotionIndex = function(card, reverse)\n    local i = getEmotionIndex(card)\n    if reverse then\n        return ((i - 2) % #EMOTIONS) + 1\n    else\n        return (i % #EMOTIONS) + 1\n    end\nend\n\n-----------------------------------------\n-- Initialization\n-----------------------------------------\n\nlocal function runSetup()\n    if initialized then return end\n\n    -- Get player color from Global\n    local color = Global.call(\"getSpiritColor\", {name = spiritName})\n    if not color then return end  -- Spirit not set up yet\n\n    initialized = true\n    playerColor = color\n\n    -- Get the parent spirit panel\n    spiritPanel = self.getParent()\n    if not spiritPanel then return end\n\n    local position = spiritPanel.getPosition() + Vector(-8.2,-0.22,6.8)\n    pos = position\n\n    -- Find the Season Wheel\n    for _, obj in ipairs(getAllObjects()) do\n        if obj.getName():find(\"Season Wheel\") then\n            seasonWheel = obj\n            break\n        end\n    end\n\n    -- Spawn the new hand (hand index 3)\n    local handPosition = Player[color].getHandTransform(2).position\n    handPosition.z = handPosition.z - 5.5\n    Global.call(\"SpawnHand\", {color = color, position = handPosition})\n\n    -- Determine starting emotion from wheel\n    local startingEmotion = getWheelEmotion()\n\n    -- Process Innate cards\n    local hand = Player[color].getHandObjects(1)\n    Wait.frames(function()\n        if hand ~= {} then\n            local startingCard = findInnateWithTagInHandObjects(hand, startingEmotion)\n\n            for _,card in pairs(hand) do\n                if card.hasTag(\"Innate\") then\n                    if card == startingCard then\n                        local targetPos = pos + Vector(13, 0.5, -10)\n                        card.setPosition(targetPos, false)\n                    else\n                        card.deal(1, color, 3)\n                    end\n                end\n            end\n        end\n    end, 1)\n\n    -- Create the button on the panel\n    createPanelButtons(spiritPanel)\nend\n\n-- Poll for setup completion\nlocal function waitForSetup()\n    if initialized then return end\n\n    -- Check if spirit is set up by trying to get the color\n    local color = Global.call(\"getSpiritColor\", {name = spiritName})\n    if color then\n        runSetup()\n    else\n        -- Keep polling every second\n        Wait.time(waitForSetup, 1)\n    end\nend\n\nfunction onLoad(saved_data)\n    -- Start polling for when spirit is set up\n    Wait.time(waitForSetup, 2)\nend\n\n-----------------------------------------\n-- Panel button creation\n-----------------------------------------\n\nfunction createPanelButtons(panel)\n    panel.createButton({\n        click_function = \"changeSeason\",\n        function_owner = self,\n        label = \"Change Season\",\n        position = {-0.93,0.5,0},\n        scale = {x=0.08, y=0.08, z=0.08},\n        width = 5000,\n        height = 750,\n        font_size = 750,\n        color = {1,1,1},\n        font_color = {0,0,0},\n        tooltip = \"Left-click: Next Season | Right-click: Previous Season\",\n    })\nend\n\n-----------------------------------------\n-- Change Season (button click handler)\n-----------------------------------------\n\nfunction changeSeason(obj, player_color, alt_click)\n    if busy then return end\n    busy = true\n\n    local color = Global.call(\"getSpiritColor\", {name = spiritName})\n    local reverse = alt_click\n\n    local hits = Physics.cast({\n        origin = obj.getPosition() + Vector(5,0,-5),\n        direction = Vector(0,1,0),\n        type = 3,\n        size = {6,1,6.5},\n        max_distance = 1,\n    })\n\n    local innateCard = nil\n    for _, hit in pairs(hits) do\n        local card = hit.hit_object\n        if card and card.hasTag(\"Innate\") then\n            innateCard = card\n            break\n        end\n    end\n\n    if innateCard then\n        local targetPos = innateCard.getPosition()\n        local targetRot = innateCard.getRotation()\n\n        local nextIndex = getNextEmotionIndex(innateCard, reverse)\n        local wantTag = EMOTIONS[nextIndex]\n\n        innateCard.deal(1, color, 3)\n\n        local replacement = findInnateWithTagInHand(color, 3, wantTag)\n        if replacement then\n            replacement.setPosition(targetPos, false)\n            replacement.setRotation(targetRot, false)\n        end\n\n        setWheelToEmotion(wantTag)\n    else\n        local replacement = findInnateWithTagInHand(color, 3, \"Ire\")\n        if replacement then\n            replacement.setPosition(pos + Vector(13,0.5,-10), false)\n        end\n    end\n\n    Wait.frames(function()\n        busy = false\n    end, 20)\nend\n\n-----------------------------------------\n-- Time Passes handler\n-----------------------------------------\n\nfunction timePasses()\n    if not spiritPanel then return end\n\n    local color = Global.call(\"getSpiritColor\", {name = spiritName})\n    local hits = Physics.cast({\n        origin = spiritPanel.getPosition() + Vector(5,0,-5),\n        direction = Vector(0,1,0),\n        type = 3,\n        size = {6,1,6.5},\n        max_distance = 1,\n    })\n\n    local innateCard = nil\n    for _, hit in pairs(hits) do\n        local card = hit.hit_object\n        if card and card.hasTag(\"Innate\") then\n            innateCard = card\n            break\n        end\n    end\n\n    if innateCard then\n        local targetPos = innateCard.getPosition()\n        local targetRot = innateCard.getRotation()\n\n        local nextIndex = getNextEmotionIndex(innateCard, false)\n        local wantTag = EMOTIONS[nextIndex]\n\n        innateCard.deal(1, color, 3)\n\n        local replacement = findInnateWithTagInHand(color, 3, wantTag)\n        if replacement then\n            replacement.setPosition(targetPos, false)\n            replacement.setRotation(targetRot, false)\n        end\n\n        setWheelToEmotion(wantTag)\n    else\n        local replacement = findInnateWithTagInHand(color, 3, \"Ire\")\n        if replacement then\n            replacement.setPosition(pos + Vector(13,0.5,-10), false)\n        end\n    end\nend\n\n-----------------------------------------\n-- Cost modification\n-----------------------------------------\n\nfunction modifyCost(params)\n    local costs = params.costs\n    if params.color == Global.call(\"getSpiritColor\", {name = spiritName}) then\n        for guid,_ in pairs(costs) do\n            if impendTable[guid] then\n                costs[guid] = 0\n            end\n        end\n    end\n    return costs\nend\n",
          "LuaScriptState": "",
          "XmlUI": ""
        }
      ]
    }
  ]
}