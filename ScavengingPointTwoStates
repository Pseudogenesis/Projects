{
  "SaveName": "",
  "Date": "",
  "VersionNumber": "",
  "GameMode": "",
  "GameType": "",
  "GameComplexity": "",
  "Tags": [],
  "Gravity": 0.5,
  "PlayArea": 0.5,
  "Table": "",
  "Sky": "",
  "Note": "",
  "TabStates": {},
  "LuaScript": "",
  "LuaScriptState": "",
  "XmlUI": "",
  "ObjectStates": [
    {
      "GUID": "2c6933",
      "Name": "Custom_Token",
      "Transform": {
        "posX": -33.0834923,
        "posY": 8.601229,
        "posZ": 102.571083,
        "rotX": 5.165528E-07,
        "rotY": 180.006348,
        "rotZ": -8.53253368E-07,
        "scaleX": 0.475000441,
        "scaleY": 1.0,
        "scaleZ": 0.475000441
      },
      "Nickname": "Scavenging Point",
      "Description": "Place this wherever you want. You can right click eligible Tokens, then hit Scavenge Token to send them here!\n\nChange states to reduce transparency",
      "GMNotes": "",
      "AltLookAngle": {
        "x": 0.0,
        "y": 0.0,
        "z": 0.0
      },
      "ColorDiffuse": {
        "r": 1.0,
        "g": 1.0,
        "b": 1.0
      },
      "LayoutGroupSortIndex": 0,
      "Value": 0,
      "Locked": true,
      "Grid": true,
      "Snap": true,
      "IgnoreFoW": false,
      "MeasureMovement": false,
      "DragSelectable": true,
      "Autoraise": true,
      "Sticky": true,
      "Tooltip": true,
      "GridProjection": false,
      "HideWhenFaceDown": false,
      "Hands": false,
      "CustomImage": {
        "ImageURL": "https://steamusercontent-a.akamaihd.net/ugc/13916511082507550003/EB7480B64BF5328938F1B5ED66C8C860CD33531F/",
        "ImageSecondaryURL": "",
        "ImageScalar": 1.0,
        "WidthScale": 0.0,
        "CustomToken": {
          "Thickness": 0.1,
          "MergeDistancePixels": 15.0,
          "StandUp": false,
          "Stackable": false
        }
      },
      "LuaScript": "--[[\r\n    Scavenger of Fates - Scavenging Automation Script\r\n\r\n    Adds a \"Scavenge Token\" context menu option to Beasts, Badlands, Wilds, and Disease tokens,\r\n    allowing any player to send them to this object's position.\r\n\r\n    Also registers a hotkey \"Scavenge Token\" that players can bind in Options > Game Keys.\r\n\r\n    Setup: Position this object where you want Scavenged tokens to land.\r\n    Change states to toggle transparency (script works in both states).\r\n]]--\r\n\r\n-- Configuration\r\nlocal SCAVENGEABLE_TYPES = {\"Beasts\", \"Badlands\", \"Wilds\", \"Disease\"}\r\nlocal MENU_LABEL = \"Scavenge Token\"\r\nlocal HOTKEY_LABEL = \"Scavenge Token\"\r\nlocal REGISTERED_TAG = \"ScavengerRegistered\"  -- Tag to track registered tokens\r\n\r\n--[[\r\n    Check if an object is a scavengeable token type\r\n    Uses both name and tag checking for reliability\r\n]]--\r\nfunction isScavengeable(obj)\r\n    if obj == nil then return false end\r\n\r\n    local objName = obj.getName()\r\n\r\n    for _, tokenType in ipairs(SCAVENGEABLE_TYPES) do\r\n        -- Check by name\r\n        if objName == tokenType then\r\n            return true\r\n        end\r\n        -- Check by tag as backup\r\n        if obj.hasTag and obj.hasTag(tokenType) then\r\n            return true\r\n        end\r\n    end\r\n\r\n    return false\r\nend\r\n\r\n--[[\r\n    Move a token to the scavenging area\r\n]]--\r\nfunction scavengeToken(playerColor, tokenObject)\r\n    if tokenObject == nil then\r\n        return false\r\n    end\r\n\r\n    -- Get this script object's position as the target\r\n    local targetPos = self.getPosition()\r\n\r\n    -- Add a small random offset to prevent tokens from stacking exactly on top of each other\r\n    local randomOffset = {\r\n        x = (math.random() - 0.5) * 0.5,\r\n        z = (math.random() - 0.5) * 0.5\r\n    }\r\n\r\n    targetPos.x = targetPos.x + randomOffset.x\r\n    targetPos.z = targetPos.z + randomOffset.z\r\n    targetPos.y = targetPos.y + 0.5  -- Slightly above to drop onto surface\r\n\r\n    -- Move the token smoothly to the scavenging area\r\n    tokenObject.setPositionSmooth(targetPos, false, true)\r\n\r\n    -- Provide feedback to the player\r\n    local tokenName = tokenObject.getName()\r\n    print(playerColor .. \" Scavenged a \" .. tokenName .. \" token.\")\r\n\r\n    return true\r\nend\r\n\r\n--[[\r\n    Callback function when \"Scavenge Token\" is selected from context menu\r\n    Moves the clicked object to this script object's position\r\n]]--\r\nfunction onScavengeToken(playerColor, position, clickedObject)\r\n    if clickedObject == nil then\r\n        printToColor(\"Error: No object to Scavenge.\", playerColor, {1, 0.5, 0})\r\n        return\r\n    end\r\n\r\n    scavengeToken(playerColor, clickedObject)\r\nend\r\n\r\n--[[\r\n    Hotkey callback - scavenges the object the player is hovering over\r\n]]--\r\nfunction onScavengeHotkey(playerColor, hoveredObject, pointerPosition, isKeyUp)\r\n    -- Only trigger on key down, not key up\r\n    if isKeyUp then return end\r\n\r\n    if hoveredObject == nil then\r\n        printToColor(\"No object under cursor to Scavenge.\", playerColor, {1, 0.5, 0})\r\n        return\r\n    end\r\n\r\n    if not isScavengeable(hoveredObject) then\r\n        printToColor(\"This object cannot be Scavenged.\", playerColor, {1, 0.5, 0})\r\n        return\r\n    end\r\n\r\n    scavengeToken(playerColor, hoveredObject)\r\nend\r\n\r\n--[[\r\n    Add the scavenge context menu option to a single object\r\n    On state change, old callbacks become invalid so we clear and re-add\r\n]]--\r\nfunction addScavengeMenu(obj)\r\n    if obj == nil then return end\r\n\r\n    -- Only add to scavengeable token types\r\n    if not isScavengeable(obj) then\r\n        return\r\n    end\r\n\r\n    -- If previously registered, clear old (broken) callback first\r\n    if obj.hasTag and obj.hasTag(REGISTERED_TAG) then\r\n        obj.clearContextMenu()\r\n    end\r\n\r\n    -- Add the context menu item and tag to mark as registered\r\n    obj.addContextMenuItem(MENU_LABEL, onScavengeToken, false)\r\n    if obj.addTag then\r\n        obj.addTag(REGISTERED_TAG)\r\n    end\r\nend\r\n\r\n--[[\r\n    Scan all objects and add context menus to scavengeable tokens\r\n]]--\r\nfunction registerAllTokens()\r\n    for _, obj in ipairs(getObjects()) do\r\n        addScavengeMenu(obj)\r\n    end\r\nend\r\n\r\n--[[\r\n    Event handler: Called when any object is spawned/created\r\n]]--\r\nfunction onObjectSpawn(obj)\r\n    -- Small delay to ensure the object is fully initialized\r\n    Wait.time(function()\r\n        addScavengeMenu(obj)\r\n    end, 0.5)\r\nend\r\n\r\n--[[\r\n    Event handler: Called when this script object loads\r\n]]--\r\nfunction onLoad(savedData)\r\n    -- Check if this is the first time the script has loaded (not a state change)\r\n    local isFirstLoad = (savedData == nil or savedData == \"\")\r\n\r\n    -- Small delay to ensure script is fully initialized before registering\r\n    Wait.time(function()\r\n        -- Register the scavenge hotkey (players bind it in Options > Game Keys)\r\n        addHotkey(HOTKEY_LABEL, onScavengeHotkey, true)\r\n        \r\n        registerAllTokens()\r\n        if isFirstLoad then\r\n            print(\"[Scavenging Point] Ready! Tip: Set a hotkey in Options > Game Keys.\")\r\n        end\r\n    end, 1)\r\nend\r\n\r\n--[[\r\n    Event handler: Called when the game is saved\r\n    Saves state so we know the script has been initialized\r\n]]--\r\nfunction onSave()\r\n    return \"initialized\"\r\nend",
      "LuaScriptState": "",
      "XmlUI": "",
      "States": {
        "2": {
          "GUID": "2c6933",
          "Name": "Custom_Token",
          "Transform": {
            "posX": 32.22,
            "posY": 0.90309906,
            "posZ": -19.86,
            "rotX": -1.42828014E-07,
            "rotY": 180.235245,
            "rotZ": 6.036055E-07,
            "scaleX": 0.475000441,
            "scaleY": 1.0,
            "scaleZ": 0.475000441
          },
          "Nickname": "Scavenging Point",
          "Description": "Place this wherever you want. You can right click eligible Tokens, then hit Scavenge Token to send them here!\n\nChange states to reduce transparency",
          "GMNotes": "",
          "AltLookAngle": {
            "x": 0.0,
            "y": 0.0,
            "z": 0.0
          },
          "ColorDiffuse": {
            "r": 1.0,
            "g": 1.0,
            "b": 1.0,
            "a": 0.117100313
          },
          "LayoutGroupSortIndex": 0,
          "Value": 0,
          "Locked": false,
          "Grid": true,
          "Snap": true,
          "IgnoreFoW": false,
          "MeasureMovement": false,
          "DragSelectable": true,
          "Autoraise": true,
          "Sticky": true,
          "Tooltip": true,
          "GridProjection": false,
          "HideWhenFaceDown": false,
          "Hands": false,
          "CustomImage": {
            "ImageURL": "https://steamusercontent-a.akamaihd.net/ugc/13916511082507550003/EB7480B64BF5328938F1B5ED66C8C860CD33531F/",
            "ImageSecondaryURL": "",
            "ImageScalar": 1.0,
            "WidthScale": 0.0,
            "CustomToken": {
              "Thickness": 0.1,
              "MergeDistancePixels": 15.0,
              "StandUp": false,
              "Stackable": false
            }
          },
          "LuaScript": "--[[\r\n    Scavenger of Fates - Scavenging Automation Script\r\n\r\n    Adds a \"Scavenge Token\" context menu option to Beasts, Badlands, Wilds, and Disease tokens,\r\n    allowing any player to send them to this object's position.\r\n\r\n    Also registers a hotkey \"Scavenge Token\" that players can bind in Options > Game Keys.\r\n\r\n    Setup: Position this object where you want Scavenged tokens to land.\r\n    Change states to toggle transparency (script works in both states).\r\n]]--\r\n\r\n-- Configuration\r\nlocal SCAVENGEABLE_TYPES = {\"Beasts\", \"Badlands\", \"Wilds\", \"Disease\"}\r\nlocal MENU_LABEL = \"Scavenge Token\"\r\nlocal HOTKEY_LABEL = \"Scavenge Token\"\r\nlocal REGISTERED_TAG = \"ScavengerRegistered\"  -- Tag to track registered tokens\r\n\r\n--[[\r\n    Check if an object is a scavengeable token type\r\n    Uses both name and tag checking for reliability\r\n]]--\r\nfunction isScavengeable(obj)\r\n    if obj == nil then return false end\r\n\r\n    local objName = obj.getName()\r\n\r\n    for _, tokenType in ipairs(SCAVENGEABLE_TYPES) do\r\n        -- Check by name\r\n        if objName == tokenType then\r\n            return true\r\n        end\r\n        -- Check by tag as backup\r\n        if obj.hasTag and obj.hasTag(tokenType) then\r\n            return true\r\n        end\r\n    end\r\n\r\n    return false\r\nend\r\n\r\n--[[\r\n    Move a token to the scavenging area\r\n]]--\r\nfunction scavengeToken(playerColor, tokenObject)\r\n    if tokenObject == nil then\r\n        return false\r\n    end\r\n\r\n    -- Get this script object's position as the target\r\n    local targetPos = self.getPosition()\r\n\r\n    -- Add a small random offset to prevent tokens from stacking exactly on top of each other\r\n    local randomOffset = {\r\n        x = (math.random() - 0.5) * 0.5,\r\n        z = (math.random() - 0.5) * 0.5\r\n    }\r\n\r\n    targetPos.x = targetPos.x + randomOffset.x\r\n    targetPos.z = targetPos.z + randomOffset.z\r\n    targetPos.y = targetPos.y + 0.5  -- Slightly above to drop onto surface\r\n\r\n    -- Move the token smoothly to the scavenging area\r\n    tokenObject.setPositionSmooth(targetPos, false, true)\r\n\r\n    -- Provide feedback to the player\r\n    local tokenName = tokenObject.getName()\r\n    print(playerColor .. \" Scavenged a \" .. tokenName .. \" token.\")\r\n\r\n    return true\r\nend\r\n\r\n--[[\r\n    Callback function when \"Scavenge Token\" is selected from context menu\r\n    Moves the clicked object to this script object's position\r\n]]--\r\nfunction onScavengeToken(playerColor, position, clickedObject)\r\n    if clickedObject == nil then\r\n        printToColor(\"Error: No object to Scavenge.\", playerColor, {1, 0.5, 0})\r\n        return\r\n    end\r\n\r\n    scavengeToken(playerColor, clickedObject)\r\nend\r\n\r\n--[[\r\n    Hotkey callback - scavenges the object the player is hovering over\r\n]]--\r\nfunction onScavengeHotkey(playerColor, hoveredObject, pointerPosition, isKeyUp)\r\n    -- Only trigger on key down, not key up\r\n    if isKeyUp then return end\r\n\r\n    if hoveredObject == nil then\r\n        printToColor(\"No object under cursor to Scavenge.\", playerColor, {1, 0.5, 0})\r\n        return\r\n    end\r\n\r\n    if not isScavengeable(hoveredObject) then\r\n        printToColor(\"This object cannot be Scavenged.\", playerColor, {1, 0.5, 0})\r\n        return\r\n    end\r\n\r\n    scavengeToken(playerColor, hoveredObject)\r\nend\r\n\r\n--[[\r\n    Add the scavenge context menu option to a single object\r\n    On state change, old callbacks become invalid so we clear and re-add\r\n]]--\r\nfunction addScavengeMenu(obj)\r\n    if obj == nil then return end\r\n\r\n    -- Only add to scavengeable token types\r\n    if not isScavengeable(obj) then\r\n        return\r\n    end\r\n\r\n    -- If previously registered, clear old (broken) callback first\r\n    if obj.hasTag and obj.hasTag(REGISTERED_TAG) then\r\n        obj.clearContextMenu()\r\n    end\r\n\r\n    -- Add the context menu item and tag to mark as registered\r\n    obj.addContextMenuItem(MENU_LABEL, onScavengeToken, false)\r\n    if obj.addTag then\r\n        obj.addTag(REGISTERED_TAG)\r\n    end\r\nend\r\n\r\n--[[\r\n    Scan all objects and add context menus to scavengeable tokens\r\n]]--\r\nfunction registerAllTokens()\r\n    for _, obj in ipairs(getObjects()) do\r\n        addScavengeMenu(obj)\r\n    end\r\nend\r\n\r\n--[[\r\n    Event handler: Called when any object is spawned/created\r\n]]--\r\nfunction onObjectSpawn(obj)\r\n    -- Small delay to ensure the object is fully initialized\r\n    Wait.time(function()\r\n        addScavengeMenu(obj)\r\n    end, 0.5)\r\nend\r\n\r\n--[[\r\n    Event handler: Called when this script object loads\r\n]]--\r\nfunction onLoad(savedData)\r\n    -- Check if this is the first time the script has loaded (not a state change)\r\n    local isFirstLoad = (savedData == nil or savedData == \"\")\r\n\r\n    -- Small delay to ensure script is fully initialized before registering\r\n    Wait.time(function()\r\n        -- Register the scavenge hotkey (players bind it in Options > Game Keys)\r\n        addHotkey(HOTKEY_LABEL, onScavengeHotkey, true)\r\n        \r\n        registerAllTokens()\r\n        if isFirstLoad then\r\n            print(\"[Scavenging Point] Ready! Tip: Set a hotkey in Options > Game Keys.\")\r\n        end\r\n    end, 1)\r\nend\r\n\r\n--[[\r\n    Event handler: Called when the game is saved\r\n    Saves state so we know the script has been initialized\r\n]]--\r\nfunction onSave()\r\n    return \"initialized\"\r\nend",
          "LuaScriptState": "",
          "XmlUI": ""
        }
      }
    }
  ]
}
